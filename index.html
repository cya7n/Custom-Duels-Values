<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sword Value Tracker</title>
    <meta property="og:title" content="Sword Value Tracker">
    <meta property="og:description" content="Track values of Godlies, Exclusives, Events and Legendaries">
    <meta property="og:image" content="https://i.postimg.cc/k4hg7Pt4/output-8-min.png">
    <meta property="og:url" content="https://cya7n.github.io/Custom-Duels-Values/">
    <meta property="og:type" content="website">
    
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Sword Value Tracker">
    <meta name="twitter:description" content="Track values of Godlies, Exclusives, Events and Legendaries">
    <meta name="twitter:image" content="https://i.postimg.cc/k4hg7Pt4/output-8-min.png">
    
    <!-- Favicon for browser tab -->
    <link rel="icon" href="https://i.postimg.cc/k4hg7Pt4/output-8-min.png" type="image/png">
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="apple-touch-icon" sizes="180x180" href="https://i.postimg.cc/k4hg7Pt4/output-8-min.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://i.postimg.cc/k4hg7Pt4/output-8-min.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://i.postimg.cc/k4hg7Pt4/output-8-min.png">
    <link rel="manifest" href="/site.webmanifest">
    <style>
        :root {
            --primary: #2c3e50;
            --secondary: #7f8c8d;
            --accent: #3498db;
            --godly: #e74c3c;
            --exclusive: #9b59b6;
            --event: #27ae60;
            --legendary: #f39c12;
            --unobtainable: #1abc9c;
            --notes: #e67e22;
            --cyan-approved: #1abc9c;
            --gay: #e84393;
            --demand-horrible: #95a5a6;
            --demand-bad: #e74c3c;
            --demand-normal: #3498db;
            --demand-good: #2ecc71;
            --demand-incredible: #9b59b6;
            --win-color: #2ecc71;
            --fair-color: #f39c12;
            --lose-color: #e74c3c;
            
            /* Light mode colors */
            --bg-color: #f5f5f5;
            --card-bg: white;
            --text-color: #2c3e50;
            --border-color: #eee;
            --shadow-color: rgba(0,0,0,0.05);
            --modal-bg: white;
            --input-bg: white;
            --input-border: #ddd;
            --admin-panel-bg: #f8f9fa;
            --calculator-bg: #ffffff;
        }

        .dark-mode {
            --bg-color: #1a1a1a;
            --card-bg: #2d2d2d;
            --text-color: #f0f0f0;
            --border-color: #444;
            --shadow-color: rgba(0,0,0,0.2);
            --modal-bg: #333;
            --input-bg: #444;
            --input-border: #555;
            --admin-panel-bg: #252525;
            --calculator-bg: #2d2d2d;
        }

        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
            background: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
            transition: background 0.3s, color 0.3s;
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            padding-top: 100px;
        }

        .admin-only {
            display: none;
        }

        body.admin-mode .admin-only {
            display: block;
        }

        /* Fixed header styles */
        .fixed-header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: var(--bg-color);
            padding: 10px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 1000;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            transition: background 0.3s;
        }

        .header-content {
            max-width: 1200px;
            width: 100%;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-buttons {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .view-toggle {
            background: var(--border-color);
            border: none;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
            color: var(--text-color);
        }

        .login-btn, .logout-btn, .theme-toggle {
            padding: 8px 12px;
            background: var(--accent);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9em;
            white-space: nowrap;
        }

        .logout-btn {
            background: #e74c3c;
            display: none;
        }

        .theme-toggle {
            background: var(--secondary);
        }

        .header {
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--border-color);
            text-align: center;
        }

        .category-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
            overflow-x: auto;
            padding-bottom: 10px;
            scrollbar-width: thin;
            scrollbar-color: var(--accent) transparent;
        }

        .category-tabs::-webkit-scrollbar {
            height: 6px;
        }

        .category-tabs::-webkit-scrollbar-thumb {
            background-color: var(--accent);
            border-radius: 3px;
        }

        .tab-btn {
            padding: 10px 15px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            background: var(--border-color);
            transition: all 0.3s;
            color: var(--text-color);
            flex-shrink: 0;
        }

        .tab-btn.active {
            color: white;
        }

        .godly-btn.active { background: var(--godly); }
        .exclusive-btn.active { background: var(--exclusive); }
        .event-btn.active { background: var(--event); }
        .legendary-btn.active { background: var(--legendary); }
        .unobtainable-btn.active { background: var(--unobtainable); }
        .all-btn.active { background: var(--primary); }

        /* Grid View */
        .sword-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
        }

        /* List View - Simplified */
        .sword-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .sword-list .sword-card {
            display: flex;
            align-items: center;
            padding: 12px;
            background: var(--card-bg);
            border-radius: 6px;
            border-top: 4px solid var(--border-color);
        }

        .sword-list .sword-card img {
            width: 50px;
            height: 50px;
            margin-right: 15px;
            object-fit: contain;
        }

        .sword-list .sword-info {
            flex: 1;
        }

        .sword-list .sword-info h3 {
            margin: 0;
            font-size: 1.1em;
        }

        .sword-list .sword-meta {
            display: flex;
            gap: 10px;
            margin-top: 5px;
            font-size: 0.9em;
        }

        .sword-list .sword-value {
            font-weight: bold;
        }

        .sword-list .sword-actions {
            display: flex;
            gap: 8px;
        }

        /* Grid Card Styles */
        .sword-card {
            background: var(--card-bg);
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 8px var(--shadow-color);
            transition: transform 0.2s, box-shadow 0.2s;
            border-top: 4px solid var(--border-color);
            cursor: pointer;
        }

        .sword-card img {
            max-width: 100%;
            height: auto;
            max-height: 150px;
            object-fit: contain;
            display: block;
            margin: 0 auto 10px;
            filter: drop-shadow(0 0 5px rgba(0,0,0,0.3));
            transition: filter 0.3s;
        }

        .dark-mode .sword-card img {
            filter: drop-shadow(0 0 8px rgba(255,255,255,0.2));
        }

        .sword-card.godly { border-color: var(--godly); }
        .sword-card.exclusive { border-color: var(--exclusive); }
        .sword-card.event { border-color: var(--event); }
        .sword-card.legendary { border-color: var(--legendary); }
        .sword-card.unobtainable { border-color: var(--unobtainable); }

        .sword-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 12px var(--shadow-color);
        }

        .sword-value {
            font-size: 1.4em;
            font-weight: 700;
            margin: 10px 0;
        }

        .sword-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: opacity 0.2s;
        }

        .btn-primary {
            background: var(--accent);
            color: white;
        }

        .btn-secondary {
            background: var(--secondary);
            color: white;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            justify-content: center;
            align-items: center;
            z-index: 2000;
        }

        .modal-content {
            background: var(--modal-bg);
            padding: 30px;
            border-radius: 10px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
            max-height: 90vh;
            overflow-y: auto;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
        }

        input, select, textarea {
            width: 100%;
            padding: 10px;
            background: var(--input-bg);
            color: var(--text-color);
            border: 1px solid var(--input-border);
            border-radius: 6px;
            box-sizing: border-box;
        }

        .admin-panel {
            background: var(--admin-panel-bg);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        /* Notes Panel Styles */
        .notes-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
        }

        .notes-toggle {
            background: var(--notes);
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 1.2em;
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.2s;
        }

        .notes-toggle:hover {
            transform: scale(1.1);
        }

        .notes-panel {
            position: absolute;
            bottom: 60px;
            right: 0;
            width: 300px;
            max-height: 400px;
            background: var(--card-bg);
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            padding: 15px;
            overflow-y: auto;
            display: none;
            border-left: 4px solid var(--notes);
        }

        .notes-panel h3 {
            margin-top: 0;
            color: var(--notes);
        }

        .notes-panel.active {
            display: block;
            animation: fadeIn 0.3s ease-in-out;
        }

        /* Sword Details Modal - Improved for Tablets */
        .sword-details {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }

        .sword-details-content {
            background: var(--modal-bg);
            border-radius: 10px;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            padding: 30px;
            position: relative;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .close-details {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 1.5em;
            cursor: pointer;
            color: var(--secondary);
        }

        .sword-details-img {
            max-width: 100%;
            max-height: 200px;
            display: block;
            margin: 0 auto 20px;
            border-radius: 5px;
        }

        .sword-details-name {
            font-size: 1.8em;
            margin-bottom: 10px;
            color: var(--text-color);
        }

        .sword-details-value {
            font-size: 1.5em;
            font-weight: bold;
            margin-bottom: 15px;
            color: var(--text-color);
        }

        .sword-details-category {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 20px;
            font-weight: bold;
            margin-bottom: 15px;
            color: white;
        }

        .sword-details-info {
            margin-bottom: 15px;
            line-height: 1.6;
        }

        .sword-details-info strong {
            color: var(--accent);
        }

        .sword-details-info div {
            margin-bottom: 10px;
        }

        .cyan-approved {
            color: var(--cyan-approved);
            font-weight: bold;
        }

        .gay {
            color: var(--gay);
            font-weight: bold;
        }

        /* Demand indicators */
        .demand-horrible { color: var(--demand-horrible); }
        .demand-bad { color: var(--demand-bad); }
        .demand-normal { color: var(--demand-normal); }
        .demand-good { color: var(--demand-good); }
        .demand-incredible { color: var(--demand-incredible); }

        /* Trade Calculator Styles */
        .calculator-container {
            background: var(--calculator-bg);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 2px 8px var(--shadow-color);
            display: none;
        }

        .calculator-title {
            margin-top: 0;
            margin-bottom: 15px;
            color: var(--accent);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .calculator-toggle {
            background: none;
            border: none;
            color: var(--secondary);
            cursor: pointer;
            font-size: 1.2em;
        }

        .calculator-grid {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 15px;
            align-items: start;
        }

        .calculator-column {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .calculator-equals {
            font-size: 1.5em;
            font-weight: bold;
            text-align: center;
            padding-top: 20px;
        }

        .calculator-result {
            font-size: 1.2em;
            font-weight: bold;
            text-align: center;
            padding: 10px;
            background: var(--border-color);
            border-radius: 6px;
            margin-top: 10px;
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .calculator-result-value {
            font-size: 0.9em;
            font-weight: normal;
        }

        .calculator-trade-side {
            border: 1px solid var(--border-color);
            border-radius: 6px;
            padding: 10px;
        }

        .calculator-item {
            display: flex;
            gap: 10px;
            align-items: center;
            margin-bottom: 10px;
        }

        .calculator-item:last-child {
            margin-bottom: 0;
        }

        .calculator-select {
            flex: 1;
            padding: 8px;
            border-radius: 4px;
            border: 1px solid var(--input-border);
            background: var(--input-bg);
            color: var(--text-color);
        }

        .calculator-input {
            width: 60px;
            padding: 8px;
            border-radius: 4px;
            border: 1px solid var(--input-border);
            background: var(--input-bg);
            color: var(--text-color);
            text-align: center;
        }

        .calculator-add-btn {
            background: var(--accent);
            color: white;
            border: none;
            border-radius: 4px;
            padding: 8px;
            cursor: pointer;
            margin-top: 5px;
        }

        .calculator-remove-btn {
            background: none;
            border: none;
            color: var(--secondary);
            cursor: pointer;
            font-size: 1.2em;
            padding: 0 5px;
        }

        .wfl-win {
            color: var(--win-color);
            font-weight: bold;
        }

        .wfl-fair {
            color: var(--fair-color);
            font-weight: bold;
        }

        .wfl-lose {
            color: var(--lose-color);
            font-weight: bold;
        }

        /* Sort Controls */
        .sort-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .sort-select {
            padding: 8px 12px;
            border-radius: 6px;
            border: 1px solid var(--border-color);
            background: var(--input-bg);
            color: var(--text-color);
            cursor: pointer;
        }

        /* Calculator Toggle Button */
        .calculator-toggle-btn {
            background: var(--accent);
            color: white;
            border: none;
            border-radius: 6px;
            padding: 10px 15px;
            margin-bottom: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
        }

        .calculator-toggle-btn .icon {
            transition: transform 0.3s;
        }

        .calculator-toggle-btn.active .icon {
            transform: rotate(180deg);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @media (max-width: 768px) {
            .container {
                padding-top: 90px;
            }
            
            .sword-grid {
                grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
                gap: 12px;
            }
            
            .sword-card {
                padding: 12px;
                min-height: auto;
            }
            
            .sword-card img {
                max-height: 100px;
                margin-bottom: 8px;
            }
            
            .sword-value {
                font-size: 1.2em;
            }
            
            .tab-btn {
                padding: 8px 12px;
                font-size: 0.85em;
            }
            
            .admin-panel {
                padding: 10px;
            }

            .notes-panel {
                width: 250px;
                max-height: 300px;
            }

            .sword-details-content {
                padding: 20px;
            }

            .sword-details-img {
                max-height: 150px;
            }

            .sword-list .sword-card {
                flex-direction: row;
                align-items: center;
            }

            .sword-list .sword-card img {
                margin-right: 15px;
                margin-bottom: 0;
            }

            .calculator-grid {
                grid-template-columns: 1fr;
            }

            .calculator-equals {
                display: none;
            }
        }

        @media (max-width: 480px) {
            .sword-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .fixed-header {
                padding: 10px;
            }
            
            .header-buttons {
                gap: 5px;
            }
            
            .login-btn, .logout-btn, .theme-toggle, .view-toggle {
                padding: 6px 10px;
                font-size: 0.8em;
            }

            .notes-container {
                bottom: 10px;
                right: 10px;
            }

            .notes-panel {
                width: 200px;
                max-height: 250px;
            }
            
            .notes-toggle {
                width: 40px;
                height: 40px;
                font-size: 1em;
            }

            .sword-details-content {
                padding: 15px;
            }

            .sword-details-name {
                font-size: 1.5em;
            }

            .sword-list .sword-card {
                padding: 10px;
            }

            .sort-controls {
                flex-direction: column;
                align-items: flex-start;
            }
        }

        .copyright-notice {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            color: var(--secondary);
            font-size: 0.9em;
            border-top: 1px solid var(--border-color);
        }
    </style>
</head>
<body>
    <!-- Fixed Header -->
    <div class="fixed-header">
        <div class="header-content">
            <div style="display: flex; align-items: center; gap: 10px;">
                <img src="https://i.postimg.cc/k4hg7Pt4/output-8-min.png" alt="Logo" style="height: 40px; width: auto;">
                <h1 style="margin: 0; font-size: 1.5em;">Sword Value Tracker</h1>
            </div>
            <div class="header-buttons">
                <button class="view-toggle" id="viewToggle">
                    <span id="viewIcon">☰</span> <span id="viewText">List</span>
                </button>
                <button class="theme-toggle" id="themeToggle">Dark Mode</button>
                <button class="login-btn" id="loginBtn">Admin</button>
                <button class="logout-btn" id="logoutBtn">Logout</button>
            </div>
        </div>
    </div>
    
    <div class="container">
        <div class="header">
            <p>Track values of Godlies, Exclusives, Events and Legendaries</p>
        </div>

        <!-- Trade Calculator Toggle -->
        <button class="calculator-toggle-btn" id="calculatorToggle">
            <span>Trade Calculator</span>
            <span class="icon">▼</span>
        </button>

    <!-- Trade Calculator -->
    <div class="calculator-container" id="calculatorContainer">
        <div class="calculator-grid">
            <div class="calculator-column">
                <h4>Your Offer</h4>
                <div class="calculator-trade-side" id="leftTradeSide">
                    <div class="calculator-item">
                        <select class="calculator-select calculator-sword-select">
                            <option value="">Select Sword</option>
                        </select>
                        <input type="number" class="calculator-input" value="1" min="1">
                        <button class="calculator-remove-btn">×</button>
                    </div>
                </div>
                <button class="calculator-add-btn" id="addLeftItem">+ Add Sword</button>
            </div>
            
            <div class="calculator-equals">=</div>
            
            <div class="calculator-column">
                <h4>Their Offer</h4>
                <div class="calculator-trade-side" id="rightTradeSide">
                    <div class="calculator-item">
                        <select class="calculator-select calculator-sword-select">
                            <option value="">Select Sword</option>
                        </select>
                        <input type="number" class="calculator-input" value="1" min="1">
                        <button class="calculator-remove-btn">×</button>
                    </div>
                </div>
                <button class="calculator-add-btn" id="addRightItem">+ Add Sword</button>
            </div>
        </div>
        <div class="calculator-result" id="calculatorResult">
            <div class="result-main">Select swords to compare values</div>
            <div class="calculator-result-value" id="valueDifference"></div>
        </div>
    </div>

        <!-- Sort Controls -->
        <div class="sort-controls">
            <div class="category-tabs">
                <button class="tab-btn all-btn active" data-filter="all">All Swords</button>
                <button class="tab-btn godly-btn" data-filter="godly">Godlies</button>
                <button class="tab-btn exclusive-btn" data-filter="exclusive">Exclusives</button>
                <button class="tab-btn event-btn" data-filter="event">Events</button>
                <button class="tab-btn legendary-btn" data-filter="legendary">Legendaries</button>
                <button class="tab-btn unobtainable-btn" data-filter="unobtainable">Unobtainables</button>
            </div>
            <select class="sort-select" id="sortSelect">
                <option value="value-desc">Value: High to Low</option>
                <option value="value-asc">Value: Low to High</option>
                <option value="name-asc">Name: A-Z</option>
                <option value="name-desc">Name: Z-A</option>
                <option value="exist-asc">Exist Count: Low to High</option>
                <option value="exist-desc">Exist Count: High to Low</option>
                <option value="demand-asc">Demand: Low to High</option>
                <option value="demand-desc">Demand: High to Low</option>
            </select>
        </div>

        <div class="sword-grid" id="swordGrid">
            <!-- Sword cards will be rendered here -->
        </div>

        <div class="sword-list" id="swordList" style="display: none;">
            <!-- Sword list will be rendered here -->
        </div>

        <div class="copyright-notice">
            Created by @cya7n (Discord ID: 899626902648684584)
        </div>

        <!-- Notes Panel -->
        <div class="notes-container">
            <div class="notes-panel" id="notesPanel">
                <h3>Special Notes</h3>
                <p>1. Most legs are valued at 1 in Godly trades. Only the rarer legs can be considered as more.</p>
                <p>2. Very low serials (around 1-0) can be valued at 2x more value than the original sword's value or even higher.</p>
                <p>3. All looks and effects ratings are based solely on MY opinion, and if I think it is worth its value only based on looks and effects.</p>
                <p>4. If you are experiencing issues such as images not loading or data feeling wrong or outdated, please try to delete the website data (niew site information aka the filter button next to the url > cookie and site data > delete site data) before reaching out to me on Discord (@cya7n).</p>
                <p>5. If you have any suggestions, please dm @cya7n on Discord.</p>
            </div>
            <button class="notes-toggle" id="notesToggle">📝</button>
        </div>

        <!-- Login Modal -->
        <div class="modal" id="loginModal">
            <div class="modal-content">
                <h2>Admin Login</h2>
                <input type="password" id="adminPassword" placeholder="Enter password">
                <button class="btn btn-primary" id="confirmLoginBtn">Login</button>
                <p id="loginError" style="color: red; display: none;">Incorrect password</p>
            </div>
        </div>

        <!-- Edit Modal -->
        <div class="modal" id="editModal">
            <div class="modal-content">
                <h2 id="modalTitle">Add New Sword</h2>
                <form id="swordForm">
                    <div class="form-group">
                        <label>Sword Name</label>
                        <input type="text" id="swordName" required>
                    </div>
                    <div class="form-group">
                        <label>Value</label>
                        <input type="number" id="swordValue" required step="0.1">
                    </div>
                    <div class="form-group">
                        <label>Category</label>
                        <select id="swordCategory" required>
                            <option value="godly">Godly</option>
                            <option value="exclusive">Exclusive</option>
                            <option value="event">Event</option>
                            <option value="legendary">Legendary</option>
                            <option value="unobtainable">Unobtainable</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Demand</label>
                        <select id="swordDemand" required>
                            <option value="horrible">Horrible</option>
                            <option value="bad">Bad</option>
                            <option value="normal" selected>Normal</option>
                            <option value="good">Good</option>
                            <option value="incredible">Incredible</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Image URL (optional)</label>
                        <input type="text" id="swordImage">
                    </div>
                    <div class="form-group">
                        <label>Exist Count (optional)</label>
                        <input type="number" id="swordExistCount" placeholder="Estimated number in existence">
                    </div>
                    <div class="form-group">
                        <label>Looks Approval</label>
                        <select id="swordLooksApproval">
                            <option value="">Not specified</option>
                            <option value="cyan">Cyan Approved</option>
                            <option value="gay">Gay</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Death Effects Approval</label>
                        <select id="swordDeathEffectsApproval">
                            <option value="">Not specified</option>
                            <option value="cyan">Cyan Approved</option>
                            <option value="gay">Gay</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Additional Notes (optional)</label>
                        <textarea id="swordNotes" rows="3"></textarea>
                    </div>
                    <div class="sword-actions">
                        <button type="button" class="btn btn-secondary" id="cancelEditBtn">Cancel</button>
                        <button type="submit" class="btn btn-primary">Save</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Sword Details Modal -->
        <div class="sword-details" id="swordDetailsModal">
            <div class="sword-details-content">
                <span class="close-details" id="closeDetails">&times;</span>
                <img id="detailsImg" class="sword-details-img" src="" alt="" onerror="this.style.display='none'">
                <h2 class="sword-details-name" id="detailsName"></h2>
                <div class="sword-details-value" id="detailsValue"></div>
                <div class="sword-details-category" id="detailsCategory"></div>
                
                <div class="sword-details-info">
                    <div id="detailsDemand"></div>
                    <div id="detailsExistCount"></div>
                    <div id="detailsLooksApproval"></div>
                    <div id="detailsDeathEffectsApproval"></div>
                    <div id="detailsNotes"></div>
                </div>
                
                <div class="sword-actions admin-only" id="detailsAdminActions">
                    <button class="btn btn-primary" id="editDetailsBtn">Edit</button>
                    <button class="btn btn-secondary" id="deleteDetailsBtn">Delete</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Configuration
        const ADMIN_PASSWORD = "Geo@2009";
        
        // Sword data - now hardcoded instead of using localStorage
        const swords = [
            { 
                name: "Cupid's Arrow", 
                value: 130, 
                category: "godly", 
                demand: "incredible",
                image: "https://i.postimg.cc/4NCRTxFM/cupidarrow.png",
                existCount: 60,
                looksApproval: "gay",
                deathEffectsApproval: "gay",
                notes: "It has high value because of its scarcity. Valentines",
            },
            { 
                name: "SoC", 
                value: 105, 
                category: "godly", 
                demand: "incredible",
                image: "https://i.postimg.cc/4NRqSFYR/sinofchrist.png",
                existCount: 190,
                looksApproval: "cyan",
                deathEffectsApproval: "gay",
                notes: "It has duel swords, and the effect has been revamped recently.",
            },
            { 
                name: "Nature's Embrace", 
                value: 85, 
                category: "godly", 
                demand: "good",
                image: "https://i.postimg.cc/6qnSQC1P/nature.png",
                existCount: 100,
                looksApproval: "cyan",
                deathEffectsApproval: "gay",
                notes: "New",
            },
            { 
                name: "Behemoth", 
                value: 80, 
                category: "godly", 
                demand: "normal",
                image: "https://i.postimg.cc/BvZGw7wn/behemoth.png",
                existCount: 210,
                looksApproval: "cyan",
                deathEffectsApproval: "cyan",
                notes: "Halloween",
            },
            { 
                name: "Stardust", 
                value: 55, 
                category: "godly", 
                demand: "good",
                image: "https://i.postimg.cc/0NjBwTBD/stardust.png",
                existCount: 210,
                looksApproval: "cyan",
                deathEffectsApproval: "cyan"
            },
            { 
                name: "Empyrean", 
                value: 32, 
                category: "godly", 
                demand: "good",
                image: "https://i.postimg.cc/0yfTmd2R/empyrean.png",
                existCount: 370,
                looksApproval: "cyan",
                deathEffectsApproval: "cyan"
            },
            { 
                name: "Soul Reaper", 
                value: 15, 
                category: "exclusive", 
                demand: "normal",
                image: "https://i.postimg.cc/rw8b80Gh/soulreaper.png",
                existCount: 650,
                looksApproval: "cyan",
                deathEffectsApproval: "cyan",
                notes: "Considered to be 12 by some due to its fluctuating state.",
            },
            { 
                name: "Diadem", 
                value: 8, 
                category: "exclusive", 
                demand: "normal",
                image: "https://i.postimg.cc/qv4fzZrx/diadem.png",
                existCount: 1400,
                looksApproval: "cyan",
                deathEffectsApproval: "cyan"
            },
            { 
                name: "Angel", 
                value: 5, 
                category: "exclusive", 
                demand: "normal",
                image: "https://i.postimg.cc/4NtZK99s/angel.png",
                existCount: 800,
                looksApproval: "cyan",
                deathEffectsApproval: "cyan",
                notes: "New",
            },
            { 
                name: "Devil", 
                value: 5, 
                category: "exclusive", 
                demand: "normal",
                image: "https://i.postimg.cc/Fsj5FXMK/devil.png",
                existCount: 800,
                looksApproval: "cyan",
                deathEffectsApproval: "cyan",
                notes: "New",
            },
            { 
                name: "Boogie Bomb", 
                value: 3.5, 
                category: "legendary", 
                demand: "good",
                image: "https://i.postimg.cc/vBkFTY84/boogiebomb.png",
                existCount: 1700,
                looksApproval: "gay",
                deathEffectsApproval: "gay",
                notes: "New years, scarce",
            },
            { 
                name: "Bloodthorn", 
                value: 3, 
                category: "legendary", 
                demand: "normal",
                image: "https://i.postimg.cc/Vvtybx5D/bloodthorn.png",
                existCount: 3110,
                looksApproval: "gay",
                deathEffectsApproval: "gay",
                notes: "Halloween",
            },
            { 
                name: "Bladeless Swordsman", 
                value: 2.8, 
                category: "legendary", 
                demand: "normal",
                image: "https://i.postimg.cc/63yxB2Ks/bladeless.png",
                existCount: 5100,
                looksApproval: "cyan",
                deathEffectsApproval: "gay",
                notes: "Halloween",
            },
            { 
                name: "Harbinger", 
                value: 2.5, 
                category: "legendary", 
                demand: "normal",
                image: "https://i.postimg.cc/GpmZj8HB/harbinger.png",
                existCount: 5200,
                looksApproval: "cyan",
                deathEffectsApproval: "cyan",
                notes: "Halloween",
            },
            { 
                name: "Undead: Vengeance", 
                value: 2.5, 
                category: "legendary", 
                demand: "normal",
                image: "https://i.postimg.cc/DwBNmvB7/zomb.png",
                existCount: 3700,
                looksApproval: "cyan",
                deathEffectsApproval: "cyan",
                notes: "Halloween",
            },
            { 
                name: "Confille", 
                value: 2.5, 
                category: "legendary", 
                demand: "normal",
                image: "https://i.postimg.cc/NG2vVHbm/confille.png",
                existCount: 2000,
                looksApproval: "cyan",
                deathEffectsApproval: "cyan",
                notes: "Valentines",
            },
            { 
                name: "Skeleton Dance", 
                value: 2.2, 
                category: "legendary", 
                demand: "bad",
                image: "https://i.postimg.cc/hP86Wbmz/skeletondance.png",
                existCount: 4900,
                looksApproval: "gay",
                deathEffectsApproval: "gay",
                notes: "Halloween",
            },
            { 
                name: "Aura", 
                value: 2, 
                category: "legendary", 
                demand: "normal",
                image: "https://i.postimg.cc/rwNkj2jH/aura.png",
                existCount: 2100,
                looksApproval: "cyan",
                deathEffectsApproval: "cyan"
            },
            { 
                name: "Voidswirl", 
                value: 1.8, 
                category: "legendary", 
                demand: "normal",
                image: "https://i.postimg.cc/JzvbpShb/voidswirl.png",
                existCount: 3200,
                looksApproval: "cyan",
                deathEffectsApproval: "cyan"
            },
            { 
                name: "Golden Sleigh", 
                value: 1.8, 
                category: "legendary", 
                demand: "good",
                image: "https://i.postimg.cc/GmHFJbbL/goldensleigh.png",
                existCount: 4100,
                looksApproval: "gay",
                deathEffectsApproval: "cyan"
            },
            { 
                name: "Blackhole", 
                value: 1.5, 
                category: "legendary", 
                demand: "normal",
                image: "https://i.postimg.cc/5tPMc5Zq/blackhole.png",
                existCount: 3200,
                looksApproval: "cyan",
                deathEffectsApproval: "cyan"
            },
            { 
                name: "Low Tide", 
                value: 1.5, 
                category: "legendary", 
                demand: "normal",
                image: "https://i.postimg.cc/HxfRH635/lowtide.png",
                existCount: 2000,
                looksApproval: "cyan",
                deathEffectsApproval: "cyan",
                notes: "New",
            },
            { 
                name: "Rose Thunderbolt", 
                value: 1.5, 
                category: "legendary", 
                demand: "good",
                image: "https://i.postimg.cc/ZYdXjhKL/rose.png",
                existCount: 3600,
                looksApproval: "gay",
                deathEffectsApproval: "gay",
                notes: "Well it might be worth more than thunder if you are a girl lol...",
            },
            { 
                name: "Meteor", 
                value: 1.5, 
                category: "legendary", 
                demand: "normal",
                image: "https://i.postimg.cc/sxjSBrnR/meteor.png",
                existCount: 3200,
                looksApproval: "gay",
                deathEffectsApproval: "cyan"
            },
            { 
                name: "Sunblade", 
                value: 1.5, 
                category: "legendary", 
                demand: "normal",
                image: "https://i.postimg.cc/Hx4Xsx92/sunblade.png",
                existCount: 2000,
                looksApproval: "gay",
                deathEffectsApproval: "gay",
                notes: "New",
            },
            { 
                name: "Baphomet", 
                value: 1.3, 
                category: "legendary", 
                demand: "bad",
                image: "https://i.postimg.cc/1Rbs5H4v/baphomet.png",
                existCount: 4300,
                looksApproval: "gay",
                deathEffectsApproval: "gay"
            },
            { 
                name: "Icicle", 
                value: 1, 
                category: "legendary", 
                demand: "normal",
                image: "https://i.postimg.cc/vB1kpJ7b/icicle.png",
                existCount: 5600,
                looksApproval: "cyan",
                deathEffectsApproval: "cyan"
            },
            { 
                name: "Thunderbolt", 
                value: 1, 
                category: "legendary", 
                demand: "normal",
                image: "https://i.postimg.cc/jj1kQMp9/thunderbolt.png",
                existCount: 8200,
                looksApproval: "cyan",
                deathEffectsApproval: "cyan"
            },
            { 
                name: "Hearth", 
                value: 0.9, 
                category: "legendary", 
                demand: "good",
                image: "https://i.postimg.cc/wB4n4qmw/hearth.png",
                existCount: 12600,
                looksApproval: "gay",
                deathEffectsApproval: "gay"
            },
            { 
                name: "robloxmasterguy13", 
                value: 0.00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001, 
                category: "unobtainable", 
                demand: "horrible",
                image: "https://i.postimg.cc/QMmMnT8c/no-Filter-1.png",
                existCount: 5000000000000,
                looksApproval: "gay",
                deathEffectsApproval: "gay"
            }
        ];

        let currentEditIndex = null;
        let currentFilter = 'all';
        let currentSort = 'value-desc';
        let isAdmin = false;
        let currentDetailsIndex = null;
        let filteredSwords = [];
        let isListView = false;

        // Initialize when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            // Check for saved theme preference
            if (localStorage.getItem('darkMode') === 'enabled') {
                document.body.classList.add('dark-mode');
                document.getElementById('themeToggle').textContent = 'Light Mode';
            }
            
            // Check for saved view preference
            if (localStorage.getItem('viewMode') === 'list') {
                toggleView();
            }
            
            // Set up event listeners
            document.getElementById('loginBtn').addEventListener('click', showLoginModal);
            document.getElementById('logoutBtn').addEventListener('click', logout);
            document.getElementById('themeToggle').addEventListener('click', toggleTheme);
            document.getElementById('viewToggle').addEventListener('click', toggleView);
            document.getElementById('addSwordBtn').addEventListener('click', () => openEditModal(null));
            document.getElementById('confirmLoginBtn').addEventListener('click', checkLogin);
            document.getElementById('cancelEditBtn').addEventListener('click', closeModal);
            document.getElementById('swordForm').addEventListener('submit', handleFormSubmit);
            document.getElementById('notesToggle').addEventListener('click', toggleNotes);
            document.getElementById('closeDetails').addEventListener('click', closeDetailsModal);
            document.getElementById('editDetailsBtn').addEventListener('click', editCurrentDetails);
            document.getElementById('deleteDetailsBtn').addEventListener('click', deleteCurrentDetails);
            document.getElementById('sortSelect').addEventListener('change', function() {
                currentSort = this.value;
                filterAndSortSwords();
            });
            
            // Trade calculator event listeners
            document.getElementById('calculatorToggle').addEventListener('click', toggleCalculator);
            document.getElementById('addLeftItem').addEventListener('click', () => addTradeItem('left'));
            document.getElementById('addRightItem').addEventListener('click', () => addTradeItem('right'));
            
            // Tab filter buttons
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    filterSwords(btn.dataset.filter);
                });
            });

            // Password input on Enter key
            document.getElementById('adminPassword').addEventListener('keyup', function(e) {
                if (e.key === 'Enter') checkLogin();
            });

            // Close modal when clicking outside
            document.querySelectorAll('.modal').forEach(modal => {
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) closeModal();
                });
            });

            // Close details modal when clicking outside
            document.getElementById('swordDetailsModal').addEventListener('click', function(e) {
                if (e.target === this) closeDetailsModal();
            });

            // Initial render
            filterAndSortSwords();
            checkAuthStatus();
            populateCalculatorSelects();
            
            // Add event delegation for remove buttons
            document.getElementById('leftTradeSide').addEventListener('click', handleRemoveItem);
            document.getElementById('rightTradeSide').addEventListener('click', handleRemoveItem);
            
            // Add event delegation for calculator inputs
            document.getElementById('leftTradeSide').addEventListener('input', updateTradeCalculation);
            document.getElementById('rightTradeSide').addEventListener('input', updateTradeCalculation);
        });

        function toggleCalculator() {
            const calculator = document.getElementById('calculatorContainer');
            const toggleBtn = document.getElementById('calculatorToggle');
            
            if (calculator.style.display === 'block') {
                calculator.style.display = 'none';
                toggleBtn.classList.remove('active');
            } else {
                calculator.style.display = 'block';
                toggleBtn.classList.add('active');
            }
        }

        function toggleNotes() {
            document.getElementById('notesPanel').classList.toggle('active');
        }

        function toggleTheme() {
            document.body.classList.toggle('dark-mode');
            const isDark = document.body.classList.contains('dark-mode');
            localStorage.setItem('darkMode', isDark ? 'enabled' : 'disabled');
            document.getElementById('themeToggle').textContent = isDark ? 'Light Mode' : 'Dark Mode';
        }

        function toggleView() {
            isListView = !isListView;
            localStorage.setItem('viewMode', isListView ? 'list' : 'grid');
            
            if (isListView) {
                document.getElementById('swordGrid').style.display = 'none';
                document.getElementById('swordList').style.display = 'flex';
                document.getElementById('viewIcon').textContent = '⏹';
                document.getElementById('viewText').textContent = 'Grid';
            } else {
                document.getElementById('swordGrid').style.display = 'grid';
                document.getElementById('swordList').style.display = 'none';
                document.getElementById('viewIcon').textContent = '☰';
                document.getElementById('viewText').textContent = 'List';
            }
            
            renderSwords();
        }

        function checkAuthStatus() {
            if (localStorage.getItem('swordTrackerAuth') === ADMIN_PASSWORD) {
                enableAdminMode();
            }
        }

        function showLoginModal() {
            document.getElementById('loginModal').style.display = 'flex';
            document.getElementById('adminPassword').focus();
        }

        function checkLogin() {
            const input = document.getElementById('adminPassword').value;
            if (input === ADMIN_PASSWORD) {
                localStorage.setItem('swordTrackerAuth', ADMIN_PASSWORD);
                enableAdminMode();
                document.getElementById('loginModal').style.display = 'none';
                document.getElementById('adminPassword').value = '';
                document.getElementById('loginError').style.display = 'none';
            } else {
                document.getElementById('loginError').style.display = 'block';
            }
        }

        function enableAdminMode() {
            isAdmin = true;
            document.body.classList.add('admin-mode');
            document.getElementById('loginBtn').style.display = 'none';
            document.getElementById('logoutBtn').style.display = 'block';
            updateStats();
            renderSwords();
        }

        function logout() {
            isAdmin = false;
            localStorage.removeItem('swordTrackerAuth');
            document.body.classList.remove('admin-mode');
            document.getElementById('loginBtn').style.display = 'block';
            document.getElementById('logoutBtn').style.display = 'none';
            renderSwords();
        }

        function populateCalculatorSelects() {
            const selectElements = document.querySelectorAll('.calculator-sword-select');
            
            // Clear existing options except the first one
            selectElements.forEach(select => {
                while (select.options.length > 1) select.remove(1);
            });
            
            // Add sorted sword options
            [...swords].sort((a, b) => a.name.localeCompare(b.name)).forEach(sword => {
                const option = document.createElement('option');
                option.value = sword.name;
                option.textContent = sword.name;
                
                // Add to all select elements
                selectElements.forEach(select => {
                    select.appendChild(option.cloneNode(true));
                });
            });
        }

        function addTradeItem(side) {
            const container = document.getElementById(`${side}TradeSide`);
            const newItem = document.createElement('div');
            newItem.className = 'calculator-item';
            newItem.innerHTML = `
                <select class="calculator-select calculator-sword-select">
                    <option value="">Select Sword</option>
                </select>
                <input type="number" class="calculator-input" value="1" min="1">
                <button class="calculator-remove-btn">×</button>
            `;
            
            container.appendChild(newItem);
            
            // Populate the new select with sword options
            const select = newItem.querySelector('.calculator-sword-select');
            [...swords].sort((a, b) => a.name.localeCompare(b.name)).forEach(sword => {
                const option = document.createElement('option');
                option.value = sword.name;
                option.textContent = sword.name;
                select.appendChild(option);
            });
            
            // Add event listener for the new select
            select.addEventListener('change', updateTradeCalculation);
            
            // Add event listener for the new quantity input
            newItem.querySelector('.calculator-input').addEventListener('input', updateTradeCalculation);
            
            // Update calculation
            updateTradeCalculation();
        }

        function handleRemoveItem(e) {
            if (e.target.classList.contains('calculator-remove-btn')) {
                const item = e.target.closest('.calculator-item');
                if (item && item.parentElement.querySelectorAll('.calculator-item').length > 1) {
                    item.remove();
                    updateTradeCalculation();
                }
            }
        }

        function updateTradeCalculation() {
            const leftItems = Array.from(document.getElementById('leftTradeSide').querySelectorAll('.calculator-item'));
            const rightItems = Array.from(document.getElementById('rightTradeSide').querySelectorAll('.calculator-item'));
            
            let leftTotal = 0;
            let rightTotal = 0;
            let missingSwords = false;
            
            // Calculate left side total
            for (const item of leftItems) {
                const select = item.querySelector('.calculator-sword-select');
                const input = item.querySelector('.calculator-input');
                
                if (!select.value) {
                    missingSwords = true;
                    continue;
                }
                
                const sword = swords.find(s => s.name === select.value);
                if (sword) {
                    const quantity = parseFloat(input.value) || 1;
                    leftTotal += sword.value * quantity;
                }
            }
            
            // Calculate right side total
            for (const item of rightItems) {
                const select = item.querySelector('.calculator-sword-select');
                const input = item.querySelector('.calculator-input');
                
                if (!select.value) {
                    missingSwords = true;
                    continue;
                }
                
                const sword = swords.find(s => s.name === select.value);
                if (sword) {
                    const quantity = parseFloat(input.value) || 1;
                    rightTotal += sword.value * quantity;
                }
            }
            
            const resultElement = document.getElementById('calculatorResult');
            const valueDiffElement = document.getElementById('valueDifference');
            
            if (missingSwords || leftTotal === 0 || rightTotal === 0) {
                resultElement.querySelector('.result-main').textContent = 'Select swords to compare values';
                valueDiffElement.textContent = '';
                resultElement.className = 'calculator-result';
                return;
            }
            
            const difference = leftTotal - rightTotal;
            const absoluteDifference = Math.abs(difference);
            let resultText, resultClass, diffText;
            
            // Using 10% margin for fair trades
            if (difference > rightTotal * 0.1) {
                resultText = `W - You're gaining ${absoluteDifference.toFixed(1)} value`;
                resultClass = 'wfl-win';
                diffText = `(${leftTotal.toFixed(1)} vs ${rightTotal.toFixed(1)})`;
            } else if (difference < -rightTotal * 0.1) {
                resultText = `L - You're losing ${absoluteDifference.toFixed(1)} value`;
                resultClass = 'wfl-lose';
                diffText = `(${leftTotal.toFixed(1)} vs ${rightTotal.toFixed(1)})`;
            } else {
                resultText = `F - Values are equal`;
                resultClass = 'wfl-fair';
                diffText = `(${leftTotal.toFixed(1)} vs ${rightTotal.toFixed(1)})`;
            }
            
            resultElement.querySelector('.result-main').textContent = resultText;
            valueDiffElement.textContent = diffText;
            resultElement.className = `calculator-result ${resultClass}`;
        }

        function filterAndSortSwords() {
            filterSwords(currentFilter);
        }

        function renderSwords() {
            const grid = document.getElementById('swordGrid');
            const list = document.getElementById('swordList');
            
            grid.innerHTML = '';
            list.innerHTML = '';
            
            filteredSwords.forEach((sword, index) => {
                if (isListView) {
                    renderSwordListItem(list, sword, index);
                } else {
                    renderSwordCard(grid, sword, index);
                }
            });
            
            if (isAdmin) updateStats();
        }

        function renderSwordCard(container, sword, index) {
            const card = document.createElement('div');
            card.className = `sword-card ${sword.category}`;
            
            let imageHtml = sword.image 
                ? `<img src="${sword.image}" alt="${sword.name}" style="max-width:100%; max-height:150px; margin-bottom:10px;" onerror="this.style.display='none'">` 
                : '';
            
            card.innerHTML = `
                ${imageHtml}
                <h3>${sword.name}</h3>
                <div class="sword-value">Value: ${sword.value}</div>
                <div style="color: ${getCategoryColor(sword.category)}; font-weight:600;">
                    ${sword.category.charAt(0).toUpperCase() + sword.category.slice(1)}
                </div>
                <div class="demand-${sword.demand}" style="font-weight:600; margin:5px 0;">
                    Demand: ${formatDemand(sword.demand)}
                </div>
                ${isAdmin ? `
                <div class="sword-actions">
                    <button class="btn btn-primary" data-index="${index}">Edit</button>
                    <button class="btn btn-secondary" data-index="${index}">Delete</button>
                </div>
                ` : ''}
            `;
            
            // Add click event to show details
            card.addEventListener('click', (e) => {
                // Don't trigger if clicking on admin buttons
                if (!e.target.classList.contains('btn')) {
                    showSwordDetails(index);
                }
            });
            
            // Add event listeners for admin buttons
            if (isAdmin) {
                card.querySelector('.btn-primary').addEventListener('click', (e) => {
                    e.stopPropagation();
                    openEditModal(index, true);
                });
                card.querySelector('.btn-secondary').addEventListener('click', (e) => {
                    e.stopPropagation();
                    deleteSword(index, true);
                });
            }
            
            container.appendChild(card);
        }

        function renderSwordListItem(container, sword, index) {
            const card = document.createElement('div');
            card.className = `sword-card ${sword.category}`;
            
            let imageHtml = sword.image 
                ? `<img src="${sword.image}" alt="${sword.name}" width="50" height="50" onerror="this.style.display='none'">` 
                : '';
            
            card.innerHTML = `
                ${imageHtml}
                <div class="sword-info" style="flex: 1;">
                    <h3 style="margin: 0; font-size: 1em;">${sword.name}</h3>
                    <div class="sword-meta">
                        <div style="color: ${getCategoryColor(sword.category)};">
                            ${sword.category.charAt(0).toUpperCase() + sword.category.slice(1)}
                        </div>
                        <div class="sword-value">${sword.value}</div>
                        <div class="demand-${sword.demand}">${formatDemand(sword.demand)}</div>
                    </div>
                </div>
                ${isAdmin ? `
                <div class="sword-actions">
                    <button class="btn btn-primary" data-index="${index}">Edit</button>
                    <button class="btn btn-secondary" data-index="${index}">Delete</button>
                </div>
                ` : ''}
            `;
            
            // Add click event to show details
            card.addEventListener('click', (e) => {
                // Don't trigger if clicking on admin buttons
                if (!e.target.classList.contains('btn')) {
                    showSwordDetails(index);
                }
            });
            
            // Add event listeners for admin buttons
            if (isAdmin) {
                card.querySelector('.btn-primary').addEventListener('click', (e) => {
                    e.stopPropagation();
                    openEditModal(index, true);
                });
                card.querySelector('.btn-secondary').addEventListener('click', (e) => {
                    e.stopPropagation();
                    deleteSword(index, true);
                });
            }
            
            container.appendChild(card);
        }

        function formatDemand(demand) {
            const demandMap = {
                'horrible': 'Horrible',
                'bad': 'Bad',
                'normal': 'Normal',
                'good': 'Good',
                'incredible': 'Incredible'
            };
            return demandMap[demand] || demand;
        }

        function showSwordDetails(index) {
            currentDetailsIndex = index;
            const sword = filteredSwords[index];
            const modal = document.getElementById('swordDetailsModal');
            
            document.getElementById('detailsName').textContent = sword.name;
            document.getElementById('detailsValue').textContent = `Value: ${sword.value}`;
            
            // Set image or placeholder
            const imgElement = document.getElementById('detailsImg');
            if (sword.image) {
                imgElement.src = sword.image;
                imgElement.style.display = 'block';
            } else {
                imgElement.style.display = 'none';
            }
            
            // Set category with color
            const categoryElement = document.getElementById('detailsCategory');
            categoryElement.textContent = sword.category.charAt(0).toUpperCase() + sword.category.slice(1);
            categoryElement.style.backgroundColor = getCategoryColor(sword.category);
            
            // Set additional info - now properly shows on tablets
            document.getElementById('detailsDemand').innerHTML = 
                `<strong>Demand:</strong> <span class="demand-${sword.demand}">${formatDemand(sword.demand)}</span>`;
            
            document.getElementById('detailsExistCount').innerHTML = sword.existCount 
                ? `<strong>Exist Count:</strong> ~${sword.existCount}` 
                : '';
            
            document.getElementById('detailsLooksApproval').innerHTML = sword.looksApproval 
                ? `<strong>Looks:</strong> <span class="${sword.looksApproval}">${formatApproval(sword.looksApproval)}</span>` 
                : '';
            
            document.getElementById('detailsDeathEffectsApproval').innerHTML = sword.deathEffectsApproval 
                ? `<strong>Death Effects:</strong> <span class="${sword.deathEffectsApproval}">${formatApproval(sword.deathEffectsApproval)}</span>` 
                : '';
            
            document.getElementById('detailsNotes').innerHTML = sword.notes 
                ? `<strong>Notes:</strong> ${sword.notes}` 
                : '';
            
            // Show admin buttons if in admin mode
            document.getElementById('detailsAdminActions').style.display = isAdmin ? 'flex' : 'none';
            
            modal.style.display = 'flex';
        }

        function formatApproval(approval) {
            if (approval === 'cyan') return 'Cyan Approved';
            if (approval === 'gay') return 'Gay';
            return approval;
        }

        function closeDetailsModal() {
            document.getElementById('swordDetailsModal').style.display = 'none';
            currentDetailsIndex = null;
        }

        function editCurrentDetails() {
            if (currentDetailsIndex !== null) {
                closeDetailsModal();
                // Find the original index in the main swords array
                const swordToEdit = filteredSwords[currentDetailsIndex];
                const originalIndex = swords.findIndex(s => s.name === swordToEdit.name);
                openEditModal(originalIndex);
            }
        }

        function deleteCurrentDetails() {
            if (currentDetailsIndex !== null) {
                const swordToDelete = filteredSwords[currentDetailsIndex];
                if (confirm(`Delete ${swordToDelete.name}?`)) {
                    // Find the original index in the main swords array
                    const originalIndex = swords.findIndex(s => s.name === swordToDelete.name);
                    deleteSword(originalIndex);
                }
            }
        }

        function getCategoryColor(category) {
            const colors = {
                godly: '#e74c3c',
                exclusive: '#9b59b6',
                event: '#27ae60',
                legendary: '#f39c12',
                unobtainable: '#1abc9c'
            };
            return colors[category] || '#7f8c8d';
        }

        function updateStats() {
            const total = swords.reduce((sum, sword) => sum + Number(sword.value), 0);
            document.getElementById('totalValue').textContent = `Total Value: ${total}`;
        }

        function filterSwords(category) {
            currentFilter = category;
            
            // Filter by category
            filteredSwords = category === 'all' 
                ? [...swords] 
                : swords.filter(sword => sword.category === category);
            
            // Sort the filtered swords
            sortSwords();
            
            renderSwords();
            
            // Update active tab
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.filter === category) {
                    btn.classList.add('active');
                }
            });
        }

        function sortSwords() {
            switch(currentSort) {
                case 'value-desc':
                    filteredSwords.sort((a, b) => b.value - a.value);
                    break;
                case 'value-asc':
                    filteredSwords.sort((a, b) => a.value - b.value);
                    break;
                case 'name-asc':
                    filteredSwords.sort((a, b) => a.name.localeCompare(b.name));
                    break;
                case 'name-desc':
                    filteredSwords.sort((a, b) => b.name.localeCompare(a.name));
                    break;
                case 'exist-asc':
                    filteredSwords.sort((a, b) => (a.existCount || Infinity) - (b.existCount || Infinity));
                    break;
                case 'exist-desc':
                    filteredSwords.sort((a, b) => (b.existCount || 0) - (a.existCount || 0));
                    break;
                case 'demand-asc':
                    filteredSwords.sort((a, b) => getDemandValue(a.demand) - getDemandValue(b.demand));
                    break;
                case 'demand-desc':
                    filteredSwords.sort((a, b) => getDemandValue(b.demand) - getDemandValue(a.demand));
                    break;
                default:
                    filteredSwords.sort((a, b) => b.value - a.value);
            }
        }

        function getDemandValue(demand) {
            const demandValues = {
                'horrible': 0,
                'bad': 1,
                'normal': 2,
                'good': 3,
                'incredible': 4
            };
            return demandValues[demand] || 0;
        }

        function openEditModal(index, isFilteredIndex = false) {
            currentEditIndex = index;
            const modal = document.getElementById('editModal');
            
            if (index !== null) {
                document.getElementById('modalTitle').textContent = 'Edit Sword';
                let sword;
                if (isFilteredIndex) {
                    sword = filteredSwords[index];
                    // Find the original index in the main swords array
                    currentEditIndex = swords.findIndex(s => s.name === sword.name);
                } else {
                    sword = swords[index];
                }
                
                document.getElementById('swordName').value = sword.name;
                document.getElementById('swordValue').value = sword.value;
                document.getElementById('swordCategory').value = sword.category;
                document.getElementById('swordDemand').value = sword.demand;
                document.getElementById('swordImage').value = sword.image || '';
                document.getElementById('swordExistCount').value = sword.existCount || '';
                document.getElementById('swordLooksApproval').value = sword.looksApproval || '';
                document.getElementById('swordDeathEffectsApproval').value = sword.deathEffectsApproval || '';
                document.getElementById('swordNotes').value = sword.notes || '';
            } else {
                document.getElementById('modalTitle').textContent = 'Add New Sword';
                document.getElementById('swordForm').reset();
            }
            
            modal.style.display = 'flex';
        }

        function closeModal() {
            document.getElementById('editModal').style.display = 'none';
            document.getElementById('loginModal').style.display = 'none';
            currentEditIndex = null;
        }

        function deleteSword(index, isFilteredIndex = false) {
            let swordName;
            if (isFilteredIndex) {
                swordName = filteredSwords[index].name;
                // Find the original index in the main swords array
                index = swords.findIndex(s => s.name === swordName);
            } else {
                swordName = swords[index].name;
            }
            
            if (confirm(`Delete ${swordName}?`)) {
                swords.splice(index, 1);
                filterAndSortSwords(); // Refresh the current filter view
                populateCalculatorSelects(); // Update calculator dropdowns
            }
        }

        function handleFormSubmit(e) {
            e.preventDefault();
            
            const swordData = {
                name: document.getElementById('swordName').value,
                value: parseFloat(document.getElementById('swordValue').value),
                category: document.getElementById('swordCategory').value,
                demand: document.getElementById('swordDemand').value,
                image: document.getElementById('swordImage').value || undefined,
                existCount: document.getElementById('swordExistCount').value ? parseInt(document.getElementById('swordExistCount').value) : undefined,
                looksApproval: document.getElementById('swordLooksApproval').value || undefined,
                deathEffectsApproval: document.getElementById('swordDeathEffectsApproval').value || undefined,
                notes: document.getElementById('swordNotes').value || undefined
            };
            
            if (currentEditIndex !== null) {
                // Update existing sword
                swords[currentEditIndex] = swordData;
            } else {
                // Add new sword
                swords.push(swordData);
            }
            
            filterAndSortSwords();
            populateCalculatorSelects();
            closeModal();
            
            // Since we're not saving to localStorage, show a message
            alert("Changes are temporary in this version. Consider implementing a backend for persistent changes.");
        }
    </script>
</body>
</html>
